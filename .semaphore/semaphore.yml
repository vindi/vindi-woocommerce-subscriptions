version: v1.0
name: WooComerce
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Setup
    task:
      jobs:
        - name: Setup
          commands:
            - docker network create webproxy
            - docker-compose up -d 
            - docker cp wordpress_db:/docker-entrypoint-initdb.d/wordpress.sql dump.sql
            - docker cp dump.sql vindi.local:/var/www/html/wp-content/plugins/vindi-woocommerce-subscriptions/tests/_data/

  - name: Test
    task:
      jobs:
        - name: Test
          commands:
            - docker exec -it vindi.local composer test
